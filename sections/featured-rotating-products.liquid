<div id="product-slider">
    <p>Number of products: {{ collections.all.products.size }}</p>
    <div class="slider-container">
        <div class="product-items">
            {% for product in collections.all.products %}
                <div class="product-item {% if forloop.first %}active{% endif %}" data-index="{{ forloop.index0 }}">
                    <img src="{{ product.featured_image | img_url: 'medium' }}" alt="{{ product.title }}">
                    <p>{{ product.title }}</p>
                    <p>{{ product.price | money }}</p>
                    <a href="{{ product.url }}" class="btn btn-primary">View Product</a>
                </div>
            {% endfor %}
        </div>
    </div>
</div>

<style>
    #product-slider {
        text-align: center;
        position: relative;
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
    }

    .slider-container {
        display: flex;
        align-items: center;
        justify-content: center;
        position: relative;
    }

    .product-items {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 20px;
        position: relative;
    }

    .product-item {
        text-align: center;
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 10px;
        background-color: #f9f9f9;
        transition: transform 0.3s ease, opacity 0.3s ease;
        flex: 0 0 30%;
        opacity: 0.5;
        transform: scale(0.9);
        cursor: pointer;
    }

    .product-item.active {
        opacity: 1;
        transform: scale(1);
    }

    .product-item img {
        max-width: 100%;
        height: auto;
        border-radius: 10px;
    }

    .product-item p {
        margin: 10px 0;
    }

    .btn {
        display: inline-block;
        padding: 10px 20px;
        background-color: #007bff;
        color: #fff;
        text-decoration: none;
        border-radius: 5px;
    }
</style>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const productItems = document.querySelectorAll('.product-item');
        let currentIndex = 0;

        function showProduct(index) {
            productItems.forEach((item, i) => {
                const isActive = i === index;
                item.classList.toggle('active', isActive);
                item.style.opacity = isActive ? 1 : 0.5;
                item.style.transform = isActive ? 'scale(1)' : 'scale(0.9)';
            });

            // Reorder items to create a circular effect
            productItems.forEach((item, i) => {
                const newIndex = (i - index + productItems.length) % productItems.length;
                item.style.order = newIndex;
            });
        }

        function nextProduct() {
            currentIndex = (currentIndex + 1) % productItems.length;
            showProduct(currentIndex);
        }

        function prevProduct() {
            currentIndex = (currentIndex - 1 + productItems.length) % productItems.length;
            showProduct(currentIndex);
        }

        productItems.forEach((item, index) => {
            item.addEventListener('click', () => {
                if (!item.classList.contains('active')) {
                    currentIndex = index;
                    showProduct(currentIndex);
                }
            });
        });

        // Initial display
        showProduct(currentIndex);
    });
</script>