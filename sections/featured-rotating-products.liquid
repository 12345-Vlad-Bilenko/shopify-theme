<div id="product-slider">
    <p>Кількість продуктів: {{ collections.all.products.size }}</p>
    <div class="slider-container">
        <div class="product-wrapper">
            {% for product in collections.all.products %}
                <div class="product-item {% if forloop.first %}active{% endif %}" data-index="{{ forloop.index0 }}">
                    <img src="{{ product.featured_image | img_url: 'medium' }}" alt="{{ product.title }}">
                    <div class="product-info">
                        <p class="title">{{ product.title }}</p>
                        <p class="price">{{ product.price | money }}</p>
                        <a href="{{ product.url }}" class="btn btn-primary">Купити</a>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</div>

<style>
    #product-slider {
        text-align: center;
        position: relative;
        max-width: 900px; /* Збільшено максимальну ширину */
        margin: 0 auto;
    }

    .slider-container {
        display: flex;
        justify-content: center; /* Центруємо вміст */
        align-items: center;
        position: relative;
    }

    .product-wrapper {
        display: flex;
        align-items: center;
        gap: 20px; /* Відстань між продуктами */
    }

    .product-item {
        text-align: left; /* Вирівнюємо текст зліва */
        padding: 20px;
        border: 1px solid #ddd;
        border-radius: 10px;
        background-color: #f9f9f9;
        cursor: pointer;
        transition: transform 0.3s ease-in-out, opacity 0.3s ease-in-out, width 0.3s ease-in-out;
        width: 250px; /* Базова ширина */
    }

    .product-item.active {
        opacity: 1;
        width: 300px; /* Збільшена ширина для активного елемента */
        transform: scale(1.1); /* Невелике збільшення при активації */
        z-index: 10; /* Забезпечуємо відображення над іншими елементами */
    }

    .product-item:not(.active) {
        opacity: 0.5;
        width: 200px; /* Зменшена ширина для неактивних елементів */
    }

    .product-item img {
        max-width: 100%;
        height: auto;
        border-radius: 10px;
        margin-bottom: 10px;
    }

    .product-info {
        text-align: left;
    }

    .product-item p {
        margin: 5px 0;
    }

    .product-item .title {
        font-weight: bold;
    }

    .btn {
        display: inline-block;
        padding: 10px 20px;
        background-color: #007bff;
        color: #fff;
        text-decoration: none;
        border-radius: 5px;
        margin-top: 10px;
    }
</style>

<script>
    document.addEventListener("DOMContentLoaded", function() {
        const productItems = document.querySelectorAll('.product-item');
        const productWrapper = document.querySelector('.product-wrapper');
        let currentIndex = 0;

        function showProduct(index) {
            productItems.forEach((item, i) => {
                item.classList.toggle('active', i === index);
            });

            // Центруємо активний елемент
            const activeItem = productItems[index];
            const wrapperWidth = productWrapper.offsetWidth;
            const activeItemWidth = activeItem.offsetWidth;
            const scrollLeft = activeItem.offsetLeft - (wrapperWidth - activeItemWidth) / 2;

            productWrapper.scrollTo({
                left: scrollLeft,
                behavior: 'smooth'
            });
        }

        productItems.forEach((item, index) => {
            item.addEventListener('click', () => {
                currentIndex = index;
                showProduct(currentIndex);
            });
        });

        // Показуємо початковий активний продукт
        showProduct(currentIndex);
    });
</script>