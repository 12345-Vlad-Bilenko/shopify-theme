<div id="shopify-section-template--24432609624356__featured_rotating_products" class="shopify-section">
  <div id="product-slider" style="position: relative; text-align: center; width: 100%;">

    <!-- Лог для перевірки кількості продуктів -->
    <p>Number of products: {{ collections.all.products.size }}</p>

    <!-- Стрілки -->
    <button id="prev" class="arrow-btn" style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; font-size: 24px; cursor: pointer;" disabled>←</button>
    
    <div id="slider-container" style="display: inline-block; overflow: hidden; width: 80%; margin: 0 auto;">
      <!-- Виведення одного товару -->
      <div id="slider-item" class="product-item" style="display: flex; justify-content: center; transition: transform 0.5s;">
        <!-- Товар з рамкою по середині -->
        {% for product in collections.all.products %}
          <div class="product" style="flex-shrink: 0; width: 200px; padding: 10px; text-align: center;">
            <!-- Зображення продукту -->
            <img src="{{ product.featured_image | img_url: 'medium' }}" alt="{{ product.title }}" style="max-width: 100%; height: auto;">
            <!-- Назва продукту -->
            <p>{{ product.title }}</p>
            <!-- Ціна продукту -->
            <p>{{ product.price | money }}</p>
            <!-- Кнопка для відкриття товару -->
            <a href="{{ product.url }}" class="btn btn-primary">View Product</a>
          </div>
        {% endfor %}
      </div>
    </div>

    <!-- Стрілка вправо -->
    <button id="next" class="arrow-btn" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; font-size: 24px; cursor: pointer;">→</button>
    
    <!-- Індикація перемикання товарів -->
    <div id="indicator" style="margin-top: 20px;">
      {% for i in (0..collections.all.products.size-1) %}
        <span class="dot" style="display: inline-block; width: 10px; height: 10px; background-color: #bbb; border-radius: 50%; margin: 0 5px; cursor: pointer;"></span>
      {% endfor %}
    </div>
  </div>
</div>

<script>
  const products = {{ collections.all.products | json }};
  let currentIndex = 0;
  const totalProducts = products.length;
  const sliderContainer = document.getElementById('slider-item');
  const prevBtn = document.getElementById('prev');
  const nextBtn = document.getElementById('next');
  const dots = document.querySelectorAll('.dot');
  
  // Оновлення стану кнопок та індикаторів
  function updateUI() {
    prevBtn.disabled = currentIndex === 0;
    nextBtn.disabled = currentIndex === totalProducts - 1;

    // Оновлюємо положення слайдера
    sliderContainer.style.transform = `translateX(-${currentIndex * 220}px)`;

    // Оновлюємо індикатор
    dots.forEach((dot, index) => {
      dot.style.backgroundColor = index === currentIndex ? 'black' : '#bbb';
    });
  }

  // Перехід до наступного продукту
  function nextProduct() {
    if (currentIndex < totalProducts - 1) {
      currentIndex++;
      updateUI();
    }
  }

  // Перехід до попереднього продукту
  function prevProduct() {
    if (currentIndex > 0) {
      currentIndex--;
      updateUI();
    }
  }

  // Автоперехід кожні 15 секунд
  setInterval(nextProduct, 15000);

  // Додаємо слухачів подій для кнопок
  nextBtn.addEventListener('click', nextProduct);
  prevBtn.addEventListener('click', prevProduct);

  // Оновлення інтерфейсу при завантаженні сторінки
  updateUI();
</script>

