<div id="shopify-section-template--24432609624356__featured_rotating_products" class="shopify-section">
  <div id="product-slider">
    <!-- Лог для перевірки кількості продуктів -->
    <p>Number of products: {{ collections.all.products.size }}</p>

    <!-- Контейнер для стрілок та продуктів -->
    <div class="slider-container">
      <!-- Стрілка "Назад" -->
      <button id="prev-btn" class="slider-arrow" disabled>‹</button>

      <!-- Контейнер для продуктів -->
      <div class="product-items">
        {% for product in collections.all.products %}
          <div class="product-item {% if forloop.first %}active{% endif %}">
            <!-- Зображення продукту -->
            <img src="{{ product.featured_image | img_url: 'medium' }}" alt="{{ product.title }}">
            <!-- Назва продукту -->
            <p>{{ product.title }}</p>
            <!-- Ціна продукту -->
            <p>{{ product.price | money }}</p>
            <!-- Кнопка для відкриття товару -->
            <a href="{{ product.url }}" class="btn btn-primary">View Product</a>
          </div>
        {% endfor %}
      </div>

      <!-- Стрілка "Вперед" -->
      <button id="next-btn" class="slider-arrow">›</button>
    </div>

    <!-- Індикатори (кружочки) -->
    <div class="slider-indicators">
      {% for product in collections.all.products %}
        <span class="indicator {% if forloop.first %}active{% endif %}" data-index="{{ forloop.index0 }}"></span>
      {% endfor %}
    </div>
  </div>
</div>

<!-- Стилі -->
<style>
  #product-slider {
    text-align: center;
    position: relative;
    max-width: 800px;
    margin: 0 auto;
  }

  .slider-container {
    display: flex;
    align-items: center;
    justify-content: space-between;
    position: relative;
  }

  .product-items {
    flex: 1;
    overflow: hidden;
    position: relative;
  }

  .product-item {
    display: none;
    text-align: center;
    padding: 20px;
    border: 1px solid #ddd;
    border-radius: 10px;
    background-color: #f9f9f9;
  }

  .product-item.active {
    display: block;
  }

  .product-item img {
    max-width: 100%;
    height: auto;
    border-radius: 10px;
  }

  .product-item p {
    margin: 10px 0;
  }

  .btn {
    display: inline-block;
    padding: 10px 20px;
    background-color: #007bff;
    color: #fff;
    text-decoration: none;
    border-radius: 5px;
  }

  .slider-arrow {
    background: none;
    border: none;
    font-size: 2rem;
    cursor: pointer;
    padding: 10px;
  }

  .slider-arrow:disabled {
    color: #ccc;
    cursor: not-allowed;
  }

  .slider-indicators {
    display: flex;
    justify-content: center;
    margin-top: 20px;
  }

  .indicator {
    width: 10px;
    height: 10px;
    background-color: #ccc;
    border-radius: 50%;
    margin: 0 5px;
    cursor: pointer;
  }

  .indicator.active {
    background-color: #007bff;
  }
</style>

<!-- Скрипт для інтерактивності -->
<script>
  document.addEventListener("DOMContentLoaded", function() {
    const productItems = document.querySelectorAll('.product-item');
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const indicators = document.querySelectorAll('.indicator');
    let currentIndex = 0;
    let autoSlideInterval;

    // Функція для показу поточного продукту
    function showProduct(index) {
      productItems.forEach((item, i) => {
        item.classList.toggle('active', i === index);
      });

      indicators.forEach((indicator, i) => {
        indicator.classList.toggle('active', i === index);
      });

      // Активуємо/деактивуємо стрілки
      prevBtn.disabled = index === 0;
      nextBtn.disabled = index === productItems.length - 1;
    }

    // Функція для переходу до наступного продукту
    function nextProduct() {
      currentIndex = (currentIndex + 1) % productItems.length;
      showProduct(currentIndex);
    }

    // Функція для переходу до попереднього продукту
    function prevProduct() {
      currentIndex = (currentIndex - 1 + productItems.length) % productItems.length;
      showProduct(currentIndex);
    }

    // Автоматична зміна продуктів кожні 5 секунд
    function startAutoSlide() {
      autoSlideInterval = setInterval(nextProduct, 5000); // Змінено на 5000 мс (5 секунд)
    }

    // Зупинка автоматичної зміни
    function stopAutoSlide() {
      clearInterval(autoSlideInterval);
    }

    // Обробники подій для стрілок
    nextBtn.addEventListener('click', () => {
      stopAutoSlide();
      nextProduct();
      startAutoSlide();
    });

    prevBtn.addEventListener('click', () => {
      stopAutoSlide();
      prevProduct();
      startAutoSlide();
    });

    // Обробники подій для індикаторів
    indicators.forEach((indicator, index) => {
      indicator.addEventListener('click', () => {
        stopAutoSlide();
        currentIndex = index;
        showProduct(currentIndex);
        startAutoSlide();
      });
    });

    // Запуск автоматичної зміни
    startAutoSlide();
  });
</script>