<div id="shopify-section-template--24432609624356__featured_rotating_products" class="shopify-section">
  <div id="product-slider" style="position: relative; text-align: center; width: 100%;">

    <!-- Лог для перевірки кількості продуктів -->
    <p>Number of products: {{ collections.all.products.size }}</p>

    <!-- Стрілки -->
    <button id="prev" class="arrow-btn" style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; font-size: 24px; cursor: pointer;" disabled>←</button>
    
    <div id="slider-container" style="display: flex; overflow: hidden; justify-content: center; width: 100%; margin: 0 auto; position: relative;">
      <!-- Виведення одного активного товару -->
      <div id="slider-item" class="product-item" style="display: flex; transition: transform 0.5s;">
        {% for product in collections.all.products %}
          <div class="product {% if forloop.index0 == 0 %}active{% endif %}" style="flex-shrink: 0; width: 200px; padding: 10px; text-align: center; transition: transform 0.5s; opacity: 1; margin: 0 10px;">
            <!-- Зображення продукту -->
            <img src="{{ product.featured_image | img_url: 'medium' }}" alt="{{ product.title }}" style="max-width: 100%; height: auto; transition: transform 0.5s; border-radius: 5px;">
            <!-- Назва продукту -->
            <p>{{ product.title }}</p>
            <!-- Ціна продукту -->
            <p>{{ product.price | money }}</p>
            <!-- Кнопка для відкриття товару -->
            <a href="{{ product.url }}" class="btn btn-primary">View Product</a>
          </div>
        {% endfor %}
      </div>
    </div>

    <!-- Стрілка вправо -->
    <button id="next" class="arrow-btn" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; font-size: 24px; cursor: pointer;">→</button>
    
    <!-- Індикація перемикання товарів -->
    <div id="indicator" style="margin-top: 20px;">
      {% for i in (0..collections.all.products.size-1) %}
        <span class="dot" style="display: inline-block; width: 10px; height: 10px; background-color: #bbb; border-radius: 50%; margin: 0 5px; cursor: pointer;"></span>
      {% endfor %}
    </div>
  </div>
</div>

<script>
  const products = {{ collections.all.products | json }};
  let currentIndex = 0;
  const totalProducts = products.length;
  const sliderContainer = document.getElementById('slider-item');
  const prevBtn = document.getElementById('prev');
  const nextBtn = document.getElementById('next');
  const dots = document.querySelectorAll('.dot');
  const productItems = document.querySelectorAll('.product');

  // Оновлення стану кнопок та індикаторів
  function updateUI() {
    prevBtn.disabled = currentIndex === 0;
    nextBtn.disabled = currentIndex === totalProducts - 1;

    // Оновлюємо положення слайдера
    sliderContainer.style.transform = `translateX(-${currentIndex * 220}px)`;

    // Оновлюємо індикатор
    dots.forEach((dot, index) => {
      dot.style.backgroundColor = index === currentIndex ? 'black' : '#bbb';
    });

    // Оновлення вигляду продуктів
    productItems.forEach((item, index) => {
      if (index === currentIndex) {
        item.classList.add('active'); // Додаємо клас active для активного продукту
        item.style.transform = 'scale(1)'; // Активний продукт - більший
        item.style.opacity = '1'; // Чіткий
        item.querySelector('img').style.transform = 'scale(1.2)'; // Зображення активного продукту буде більшим
        item.style.margin = '0 0'; // Відсутність відступів для активного товару
      } else {
        item.classList.remove('active'); // Видаляємо клас active для неактивних товарів
        item.style.transform = 'scale(0.8)'; // Неактивний продукт - менший
        item.style.opacity = '0.5'; // Полупрозорий
        item.querySelector('img').style.transform = 'scale(0.8)'; // Зображення неактивного продукту буде меншим
        item.style.margin = '0 10px'; // Відступи для неактивних товарів
      }
    });
  }

  // Перехід до наступного продукту
  function nextProduct() {
    if (currentIndex < totalProducts - 1) {
      currentIndex++;
      updateUI();
    }
  }

  // Перехід до попереднього продукту
  function prevProduct() {
    if (currentIndex > 0) {
      currentIndex--;
      updateUI();
    }
  }

  // Автоперехід кожні 15 секунд
  setInterval(nextProduct, 15000);

  // Додаємо слухачів подій для кнопок
  nextBtn.addEventListener('click', nextProduct);
  prevBtn.addEventListener('click', prevProduct);

  // Оновлення інтерфейсу при завантаженні сторінки
  updateUI();
</script>

<style>
  .product {
    transition: transform 0.5s ease, opacity 0.5s ease, margin 0.5s ease;
  }

  .product.active {
    transform: scale(1) !important;  /* Активний товар - більший */
    opacity: 1 !important;  /* Чіткий */
    margin: 0 0 !important;  /* Без відступів для активного товару */
  }

  .product img {
    transition: transform 0.5s ease;
  }

  .product.active img {
    transform: scale(1.2);  /* Зображення активного продукту буде більшим */
  }
</style>
